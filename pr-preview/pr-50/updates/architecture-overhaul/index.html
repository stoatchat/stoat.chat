<!DOCTYPE html><html lang="en" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <head><meta charset="UTF-8"><meta name="description" content="How Revolt's back-end was rebuilt from the ground up along with a brand new permissions system."><meta name="keywords" content="Stoat, Revolt, chat, messaging, open-source, community, customisation"><meta name="author" content="Stoat"><meta name="theme-color" content="#8C24EC"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.14.1"><link rel="alternate" type="application/rss+xml" title="Stoat Updates Feed" href="https://stoat.chat/updates/blog-feed.xml"><link rel="alternate" type="application/rss+xml" title="Stoat Changelog Feed" href="https://stoat.chat/updates/changelog-feed.xml"><title>0.5.3 Release: Architecture Overhaul - Stoat</title><style>.technical-content-note[data-astro-cid-cztk7kcm] h3[data-astro-cid-cztk7kcm]{font-size:1rem;font-weight:700;margin:0;padding:0;line-height:1.2}.technical-content-note[data-astro-cid-cztk7kcm] p[data-astro-cid-cztk7kcm]{font-size:1rem;line-height:1.2;font-weight:400;margin-bottom:0;margin-top:.4rem;opacity:.7}.technical-content-note[data-astro-cid-cztk7kcm] a[data-astro-cid-cztk7kcm]:link,.technical-content-note[data-astro-cid-cztk7kcm] a[data-astro-cid-cztk7kcm]:visited{color:var(--cpy);text-decoration:underline;text-underline-offset:.2rem;text-decoration-color:#c7f46480}.technical-content-note[data-astro-cid-cztk7kcm] a[data-astro-cid-cztk7kcm]:link:hover,.technical-content-note[data-astro-cid-cztk7kcm] a[data-astro-cid-cztk7kcm]:visited:hover{color:var(--cpy40)}header[data-astro-cid-g6eq2fjr]{text-align:left;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-start;gap:1rem;padding-bottom:2rem}header[data-astro-cid-g6eq2fjr] h1[data-astro-cid-g6eq2fjr]{font-size:6rem;font-weight:750;margin:0;padding:0;line-height:1}@media (max-width: 768px){header[data-astro-cid-g6eq2fjr] h1[data-astro-cid-g6eq2fjr]{font-size:4rem;line-height:1}}header[data-astro-cid-g6eq2fjr] p[data-astro-cid-g6eq2fjr]{font-size:1.5rem;line-height:1.2;font-weight:500;color:#fff;margin-bottom:0;margin-top:0}body{max-width:100vw;overflow-x:hidden;margin:0;padding:0;background-color:var(--backgroundColor, black);color:var(--foreground-color, white);font-family:var(--typeface-primary);font-feature-settings:var(--typeface-primary-ffs);font-optical-sizing:auto}code{font-size:1.25em}::-webkit-scrollbar{width:3px;height:3px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--colour-ultra-pink)}.blog-header[data-astro-cid-4dqtj3le]{padding-top:15rem;max-width:min(130ch,90vw);margin:0 auto}.blog-meta[data-astro-cid-4dqtj3le]{padding:1.5rem 3rem 1.5rem 0}.blog-content[data-astro-cid-4dqtj3le]{padding-bottom:7rem}.blog-page[data-astro-cid-4dqtj3le]{max-width:min(130ch,90vw);margin:0 auto;display:grid;grid-template-columns:1fr 9fr}.blog-page[data-astro-cid-4dqtj3le] aside[data-astro-cid-4dqtj3le]{min-width:22ch;word-wrap:break-word}.cover-image[data-astro-cid-4dqtj3le]{width:100%;height:100vh;object-fit:cover;object-position:center;position:absolute;top:0;left:0;right:0;z-index:-1}.cover-image-overlay[data-astro-cid-4dqtj3le]{width:100%;height:120vh;background:linear-gradient(to bottom,rgba(0,0,0,.5),var(--backgroundColor) 60%),var(--background-image-decl) center/cover no-repeat;backdrop-filter:blur(1rem);position:absolute;top:0;left:0}.inline-cover-image[data-astro-cid-4dqtj3le]{max-width:100%;aspect-ratio:5/2;object-fit:cover;object-position:center;border-radius:.5rem;margin-bottom:3rem}@media (max-width: 768px){.blog-page[data-astro-cid-4dqtj3le]{grid-template-columns:1fr}}.meta-point[data-astro-cid-uvxvwbxm]:not(:last-child){margin-bottom:1rem}.meta-point[data-astro-cid-uvxvwbxm] h3[data-astro-cid-uvxvwbxm]{font-size:1rem;font-weight:700;margin:0;padding:0;line-height:1.2}.meta-point[data-astro-cid-uvxvwbxm] p[data-astro-cid-uvxvwbxm]{font-size:1rem;line-height:1.2;font-weight:400;margin-bottom:0;margin-top:.4rem;opacity:.7}
</style>
<link rel="stylesheet" href="/_astro/_slug_.D0Ddly4c.css">
<style>footer[data-astro-cid-35ed7um5]{color:#fff;background-color:var(--cg10);background-size:cover;background-position:center;background-opacity:.5;padding:0;padding:5rem 10rem;border-top:5px solid;border-image:linear-gradient(to right,#ff247f 0,#bf4eff 30%,#3fa8ff,#5fffb1) 1;transition:padding .5s var(--easing),flex-direction .5s var(--easing);display:flex;flex-direction:row;justify-content:space-between;align-items:flex-start}@media (max-width: 1600px){footer[data-astro-cid-35ed7um5]{padding:5rem 2rem}}@media (max-width: 1350px){footer[data-astro-cid-35ed7um5]{flex-direction:column;justify-content:center;gap:2rem}}footer[data-astro-cid-35ed7um5] .copyright-section[data-astro-cid-35ed7um5] .wordmark[data-astro-cid-35ed7um5]{width:140px;height:auto}footer[data-astro-cid-35ed7um5] .copyright-section[data-astro-cid-35ed7um5] .copyright[data-astro-cid-35ed7um5]{font-size:.9rem;margin-top:1rem;opacity:.75}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5]{display:flex;flex-direction:row;justify-content:flex-end;align-items:flex-start;gap:2.5rem}@media (max-width: 1350px){footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5]{flex-wrap:wrap;justify-content:flex-start}}@media (max-width: 600px){footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5]{flex-direction:column;justify-content:flex-start}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5]>span[data-astro-cid-35ed7um5]{font-weight:800!important;margin-bottom:0!important}}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5]{display:flex;flex-direction:column;gap:.75rem}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5] span[data-astro-cid-35ed7um5]{transition:margin-bottom .2s var(--easing),font-weight .2s var(--easing);font-weight:600;margin-bottom:1rem}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5] a[data-astro-cid-35ed7um5]:link,footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5] a[data-astro-cid-35ed7um5]:visited{color:inherit;transition:opacity .2s var(--easing),filter .2s var(--easing);text-decoration:none}footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5] a[data-astro-cid-35ed7um5]:link:hover,footer[data-astro-cid-35ed7um5] .links-section[data-astro-cid-35ed7um5] .links[data-astro-cid-35ed7um5] a[data-astro-cid-35ed7um5]:visited:hover{opacity:.75;filter:brightness(.7)}
.contentstyles p,.contentstyles ul,.contentstyles ol{line-height:1.7;font-size:1.1rem}.contentstyles code,.contentstyles kbd{font-size:1em;font-family:var(--typeface-mono)}.contentstyles kbd{background-color:var(--cpy);color:var(--colour-white);padding:.25rem .5rem;border-radius:.25rem;font-size:.9rem}.contentstyles pre{background-color:var(--colour-dark-grey);color:var(--colour-white);padding:1rem;border-radius:.5rem;overflow-x:auto;font-size:1rem}.contentstyles a:link,.contentstyles a:visited{color:var(--cpy);text-decoration:underline;text-underline-offset:.2rem;text-decoration-color:#c7f46480}.contentstyles a:link:hover,.contentstyles a:visited:hover{color:var(--cpy40)}.contentstyles h1{font-size:2.5rem;font-weight:600;margin-bottom:1rem}.contentstyles ol,.contentstyles ul{padding-left:1.75rem;margin-bottom:1rem}.contentstyles ol li,.contentstyles ul li{line-height:1.7}.contentstyles ol li::marker,.contentstyles ul li::marker{color:var(--cpx);font-family:var(--typeface-mono)}.contentstyles blockquote{border-left:.25rem solid var(--cpx);margin:1rem 0;padding:.1rem 1.5rem;background-color:#8c24ec31}.contentstyles table{width:100%;border-collapse:collapse;margin-bottom:1rem}.contentstyles table th,.contentstyles table td{padding:1rem;text-align:left}.contentstyles table th{border-bottom:4px solid var(--colour-ultra-pink);background-color:#ff005c1a}.contentstyles table tr:nth-child(2n){background-color:#ffffff0a}.contentstyles img,.contentstyles video{max-width:100%;height:auto;display:block;margin:0 auto;max-height:90vh;border-radius:.5rem}
.changelog-tag[data-astro-cid-hleeiqq6]{font-size:1rem;display:inline-block;padding:.25rem .5rem;margin-bottom:1rem;border-radius:9999px;background-color:var(--backgroundColor);color:var(--foregroundColor);letter-spacing:.05em;box-shadow:0 10px 50px #000;user-select:none}.changelog-tag[data-astro-cid-hleeiqq6].no-margin{margin-bottom:0}.link-tag[data-astro-cid-hleeiqq6]{text-decoration:none;color:inherit;display:block}
</style></head> <body data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <nav class="site-navbar"> <div class="nav-inner"> <a href="/"> <img src="/_astro/stoat-white.D05ZOrds.svg" alt="Stoat" class="wordmark"> </a> <div class="links desktop"> <a href="/download">Download</a> <a href="https://stt.gg/discover">Discover</a> <a href="https://support.stoat.chat/">Support</a> <a href="/updates">Blog</a> </div> <div class="mobile"> <button aria-label="Open mobile menu"> <img src="/_astro/menu.CTaiqBfl.svg" alt="Menu"> </button> </div> </div> <div id="mobile-menu" class="mobile-menu links"> <a href="/download">Download</a> <a href="https://stt.gg/discover">Discover</a> <a href="https://support.stoat.chat/">Support</a> <a href="/updates">Blog</a> </div> </nav>  <script type="module">document.querySelector(".mobile > button").addEventListener("click",()=>{document.querySelector(".mobile-menu").classList.contains("open")?(document.querySelector(".mobile-menu").classList.add("animate-out"),setTimeout(()=>{document.querySelector(".mobile-menu").classList.remove("animate-out"),document.querySelector(".mobile-menu").classList.remove("open")},500)):document.querySelector(".mobile-menu").classList.add("open")});</script>  <div class="blog-header" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <img alt="" aria-hidden="true" class="inline-cover-image" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <div class="changelog-tag" data-astro-cid-hleeiqq6 style="--backgroundColor: #505463;--foregroundColor: white;"> <span class="label" data-astro-cid-hleeiqq6 style="--backgroundColor: #505463;--foregroundColor: white;">API</span> </div>  <header data-astro-cid-g6eq2fjr> <h1 data-astro-cid-g6eq2fjr>0.5.3 Release: Architecture Overhaul</h1> <p data-astro-cid-g6eq2fjr>How Revolt&#39;s back-end was rebuilt from the ground up along with a brand new permissions system.</p> </header>  </div> <main class="blog-page" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <aside class="blog-meta" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;">  <div class="meta-point" data-astro-cid-uvxvwbxm> <h3 data-astro-cid-uvxvwbxm>Published</h3> <p data-astro-cid-uvxvwbxm> 8 May 2022 </p> </div> <div class="meta-point" data-astro-cid-uvxvwbxm> <h3 data-astro-cid-uvxvwbxm>Author</h3> <p data-astro-cid-uvxvwbxm>Paul Makles</p> </div> <div class="meta-point" data-astro-cid-uvxvwbxm> <div class="technical-content-note" data-astro-cid-cztk7kcm> <h3 data-astro-cid-cztk7kcm>Nerd stuff ahead!</h3> <p data-astro-cid-cztk7kcm>
This article is aimed at developers building bots and apps with the
<a href="https://developers.stoat.chat/" data-astro-cid-cztk7kcm>Stoat API</a>. It may contain
        technical jargon.
</p> </div>  </div> </aside> <article class="blog-content" data-astro-cid-4dqtj3le style="--backgroundColor: #000000;--backgroundColor: #000000;"> <div class="contentstyles">    <h1 id="its-finally-here">It‚Äôs finally here!</h1>
<p>After <a href="https://github.com/revoltchat/delta/commit/0fdb7491996e11e6e4aae189d6fc3a1f2d2a25c3">4 months of development</a>, and several weeks of teasers and hype, the old server is out and the new back-end is in.</p>
<p>The new architecture brings a host of major improvements:</p>
<ul>
<li>Re-designed permissions system</li>
<li>Private channels</li>
<li>Fully distributed</li>
<li>Abstracted from the ground up</li>
<li>Automation for API specifications</li>
<li>‚Ä¶ and honestly way too much stuff to mention</li>
</ul>
<p>We now have a really solid base to build more features on top of, the workflow has never been faster and iterating on Revolt is getting better by the day. I can only hope that this will help us develop and ship more features faster than ever before.</p>
<p>Stay Tuned üéâ</p>
<hr>
<h2 id="permissions-system">Permissions System</h2>
<p>The old permission system was in dire need of a rework, it was pretty much just a early solution.</p>
<p>It had some really serious issues:</p>
<ul>
<li>No effective ranking between roles: lower ranking roles were treated the same as higher ranking roles</li>
<li>No fine-grained overrides on roles and channels</li>
<li>No private channels</li>
</ul>
<p>This was definitely a blocking factor for communities to adopt the platform, because really nobody should be expected to operate a community with such conditions. This update is in part meant to address this problem.</p>
<h3 id="so-how-do-they-work">So how do they work?</h3>
<p>Our system departs slightly from more conventional permissions systems used on other platforms but hopefully it‚Äôll be worth it for the finer control you have over your roles and channels.</p>
<blockquote>
<p>Roles are currently given an absolute ranking, with smaller numbers taking precedence or otherwise have more priority over greater numbers. For example, <strong>-5</strong> will win out on <strong>5</strong>. We hope to build a more intuitive UI in the future.</p>
</blockquote>
<p>To calculate a user‚Äôs permissions in a server:</p>
<ul>
<li>Apply allows given by the <code>Default</code> role.</li>
<li>For each role the user has: (from lowest to highest)
<ul>
<li>Apply denies given by the role.</li>
<li>Apply allows given by the role.</li>
</ul>
</li>
</ul>
<p>In essence, this means you can do stuff like create a ‚Äúmuted‚Äù or ‚Äúrestricted‚Äù role which removes permissions granted earlier down the role hierarchy. For example, the user below has a role which restricts their ability to view channels:</p>
<p><img src="/content/blog/architecture-overhaul/example1.png" alt=""></p>
<p>Then to calculate a user‚Äôs permissions in a channel:</p>
<ul>
<li>Take the known server permissions.</li>
<li>Apply denies given by <code>Default</code> role on channel.</li>
<li>Apply allows given by <code>Default</code> role on channel.</li>
<li>For each role the user has: (from lowest to highest)
<ul>
<li>Apply denies given by the role.</li>
<li>Apply allows given by the role.</li>
</ul>
</li>
</ul>
<p>For a flow chart and more information, please see <a href="https://developers.revolt.chat/stack/delta/permissions">the developer documentation</a>.</p>
<hr>
<h2 id="abstraction">Abstraction</h2>
<p>Let‚Äôs discuss a bit about how the entire architecture has changed‚Ä¶</p>
<ul>
<li><a href="https://github.com/revoltchat/delta">delta</a> is no longer a combined API / WebSocket server, its sole job is to provide the REST API now</li>
<li><a href="https://github.com/revoltchat/quark">quark</a> is a brand new project which allows us to better structure the development of Revolt‚Äôs back-end</li>
<li><a href="https://github.com/revoltchat/bonfire">bonfire</a> is a brand new events service which replaces delta‚Äôs WebSocket server</li>
<li>In terms of Revolt‚Äôs database models, <strong>quark</strong> is split up into several layers:
<ul>
<li><code>models</code>: each model is defined separately from any logic</li>
<li><code>traits</code>: each model is given a set of traits that need to be implemented by some database</li>
<li><code>impl</code>: implementation layer for databases (we currently support a mock database and MongoDB)</li>
<li><code>generic</code>: additional generic methods which use the traits to build more complex queries and to generate events</li>
</ul>
</li>
<li>As mentioned before, everything is fully distributed by now fully relying on Redis for both PubSub and presence information across the network, components are now almost entirely plug-and-play.</li>
<li>An API specification is now generated <a href="https://api.revolt.chat/openapi.json">directly from the API</a> and can be viewed using <a href="https://api.revolt.chat/swagger">Swagger</a>.</li>
<li><a href="https://github.com/revoltchat/api">revolt-api</a> is a new JavaScript library which takes this OpenAPI specification and generates TypeScript types and provides us with a fully typed query builder.</li>
<li><a href="https://github.com/revoltchat/revolt.js">revolt.js</a> now also relies on <strong>revolt-api</strong> to provide typings and for strongly typed queries.</li>
</ul>   </div>  </article> </main> <footer data-astro-cid-35ed7um5> <div class="copyright-section" data-astro-cid-35ed7um5> <img src="/_astro/stoat-white.D05ZOrds.svg" alt="Stoat" class="wordmark" data-astro-cid-35ed7um5> <div class="copyright" data-astro-cid-35ed7um5>
¬© Revolt Platforms Ltd, 2025 </div> </div> <div class="links-section" data-astro-cid-35ed7um5> <div class="links" data-astro-cid-35ed7um5> <span data-astro-cid-35ed7um5>Stoat App</span> <a href="/download" data-astro-cid-35ed7um5>Download for Desktop</a> <a href="/download/android" data-astro-cid-35ed7um5>Download for Android</a> <a href="/download/ios" data-astro-cid-35ed7um5>Download for iOS and iPadOS</a> <a href="https://support.stoat.chat/" target="_blank" data-astro-cid-35ed7um5>Support</a> </div> <div class="links" data-astro-cid-35ed7um5> <span data-astro-cid-35ed7um5>Developers</span> <a href="https://github.com/stoatchat/" target="_blank" data-astro-cid-35ed7um5>Source Code</a> <a href="https://developers.stoat.chat/" target="_blank" data-astro-cid-35ed7um5>Documentation</a> <a href="https://translate.stoat.chat/" target="_blank" data-astro-cid-35ed7um5>Help Translate</a> </div> <div class="links" data-astro-cid-35ed7um5> <span data-astro-cid-35ed7um5>Team</span> <a href="/about" data-astro-cid-35ed7um5>About</a> <a href="/updates" data-astro-cid-35ed7um5>Blog and Changelogs</a> <a href="https://support.stoat.chat/contact" target="_blank" data-astro-cid-35ed7um5>Contact</a> </div> <div class="links" data-astro-cid-35ed7um5> <span data-astro-cid-35ed7um5>Stoat on Socials</span> <a href="https://bsky.app/profile/stoat.chat" target="_blank" data-astro-cid-35ed7um5>Bluesky</a> <a href="https://reddit.com/r/stoatchat" target="_blank" data-astro-cid-35ed7um5>Reddit</a> <a href="https://stt.gg/Testers" target="_blank" data-astro-cid-35ed7um5>Stoat Server</a> </div> <div class="links" data-astro-cid-35ed7um5> <span data-astro-cid-35ed7um5>Legal</span> <a href="/legal/community-guidelines" data-astro-cid-35ed7um5>Community Guidelines</a> <a href="/legal/terms" data-astro-cid-35ed7um5>Terms of Service</a> <a href="/legal/privacy" data-astro-cid-35ed7um5>Privacy Policy</a> <a href="/legal/imprint" data-astro-cid-35ed7um5>Imprint</a> </div> </div> </footer>   </body></html> 